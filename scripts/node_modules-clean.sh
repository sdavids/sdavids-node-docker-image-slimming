#!/usr/bin/env sh

#
# Copyright (c) 2020, Sebastian Davids
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# script needs to be invoked from project root directory

set -eu

# tooling
find node_modules \( -name 'bin' -o -name '.bin' -type d \) -exec rm -rf {} +
find node_modules -name '.vagrant' -type d -exec rm -rf {} +
find node_modules \( -name 'script' -o -name 'scripts' -type d \) -exec rm -rf {} +
find node_modules -name '.npmignore' -type f -delete
find node_modules \( -name '.eslintrc' -o -name '.eslintrc.js' -o -name '.eslintrc.json'  -o -name '.eslintrc.yml' -o -name '.eslintrc.yaml' -type f \) -delete
find node_modules -name '.editorconfig' -type f -delete
find node_modules -name '.eslintignore' -type f -delete
find node_modules -name '.coveralls.yml' -type f -delete
find node_modules -name '.travis.yml' -type f -delete
find node_modules -name '.istanbul.yml' -type f -delete
find node_modules -name '.jshintrc' -type f -delete
find node_modules -name 'Makefile' -type f -delete
find node_modules -name 'gruntfile.js' -type f -delete
find node_modules -name 'bower.json' -type f -delete
find node_modules -name 'webpack.config.js' -type f -delete
find node_modules -name 'bin.js' -type f -delete
find node_modules -name 'karma.conf.js' -type f -delete
find node_modules -name 'component.json' -type f -delete
find node_modules -name '*.patch' -type f -delete

# documentation
find node_modules \( -iname 'LICENSE' -o -iname 'LICENCE' -type f \) -delete
find node_modules -iname 'CHANGELOG' -type f -delete
find node_modules -name 'AUTHORS' -type f -delete
find node_modules \( -name '*.md' -o -name '*.markdown' -type f \) -delete
find node_modules -name '*.adoc' -type f -delete
find node_modules -name '*.rst' -type f -delete
find node_modules -name '*.txt' -type f -delete
find node_modules -name '*.html' -type f -delete
find node_modules -name '*.mli' -type f -delete
find node_modules \( -name 'jsdoc.json' -o -name 'esdoc.json' -type f \) -delete

# tests
find node_modules \( -name 'test' -o -name 'tests' -o -name 'standalone-tests' -type d \) -exec rm -rf {} +
find node_modules -name 'fixtures' -type d -exec rm -rf {} +
find node_modules -name 'coverage' -type d -exec rm -rf {} +
find node_modules \( -name 'test.js' -o -name 'test-stable.js' -o -name 'test-node.js' -type f \) -delete
find node_modules -name '*.spec.js' -type f -delete

# benchmarks
find node_modules \( -name 'benchmark' -o -name 'benchmarks' -type d \) -exec rm -rf {} +
find node_modules \( -name '*benchmark*.js' -o -name 'bench.js' -type f \) -delete

# examples
find node_modules \( -name 'example' -o -name 'examples' -type d \) -exec rm -rf {} +
find node_modules -name 'example.js' -type f -delete

# Javascript source maps and minified files
find node_modules -name '*.js.map' -type f -delete
find node_modules -name '*.min.map' -type f -delete
find node_modules -name '*.min.js' -type f -delete
find node_modules -name '*.min.js.gz' -type f -delete

# TypeScript
find node_modules -name '*.ts' -type f -delete
find node_modules -name '*.ts.map' -type f -delete

# Flow
find node_modules -name '*.flow' -type f -delete

# CSS
find node_modules -name '*.css' -type f -delete

# browser variants
find node_modules -name 'browser' -type d -exec rm -rf {} +
find node_modules \( -name 'browser.js' -o -name '*_browser.js' -o -name '*-browser.js' -type f \) -delete

# misc
find node_modules -name '*.c' -type f -delete
find node_modules \( -name '*.png' -o -name '*.jpg' -o -name '*.jpeg' -o -name '*.gif' -o -name '*.webp' -o -name '*.ico' -type f \) -delete
find node_modules \( -name '._package.json' -o -name '._LICENSE' -o -name '._ansi-color.js' -type f \) -delete
